# Indexes
This project contains several indexes that allow for faster querying of the database. A detailed report of these indexes can be found here. NOTE: actions can be found in the `lib/actions.ts` file

## User ID
An automatically generated B+ Tree Index is created by Prisma ORM on all id fields, but specifically, the index `User.id` allows for efficient searching on the User table by id, which is important for authentication procedures (controlled by Auth.js). Additionally, it helps with queries implemented by me such as `createWorkout()` and `getWorkouts()`. `createWorkout()` is used in the /log-workout route, and features connecting a created workout back to a user matching the current session's user id (exact lookup). `getWorkouts()` is used in the /workouts route and involves searching for the workouts corresponding to the user that matches the current session's user id (exact lookup). These are all very frequent queries and are therefore well-served by the index on user ID.

## Workout ID
The Workout table uses a primary key `Workout.id`, and as such, Prisma automatically generates a B+ tree index for it. This index proves to be extremely important, however, as it appears in several of my queries. Firstly, it is used in `updateWorkout()`, which appears in the /edit-workout/[workoutID] route, and allows for efficient updating of a workout by finding a workout with the given workoutID, as well as helping connect Exercises in both `updateWorkout()` and `getWorkouts()` by matching `Workout_Exercises.workout_id` to `Workout.id`. It is also used in `deleteWorkout()`, which is called from the /workouts route, and allows for efficient deletion of a workout by workoutID. It is also used for my `getAllExercises()`, `getAverages()`, `getTopTargets()`, and `getTopExercises()` queries which are all used in my /exercise-report route. These queries all involve joins of the Workout table by lookup on the `Workout.id` field, and therefore are helped by the index on `Workout.id`. As such, this is a very useful index that serves many different query scenarios.

## Exercise and Workout_Exercises
The Exercise table uses a primary key `Exercise.id`, and as such, Prisma automatically generates a B+ tree index for it. While I do not explicitly support direct querying with the Exercise table, this index is still useful in conjunction with Workout_Exercises, which has a composite primary key on [workout_id, exercise_id] which also has a B+ Tree index on it. This composite index is often used with the index on Exercise id to connect Exercises to their corresponding Workout on the basis of `exercise_id = Exercise.id` and `workout_id = Workout.id`. This is extremely helpful for queries such as `updateWorkout()` and `getWorkouts()`, which involve connection of Exercises to update or delete corresponding workouts. Additionally it is used for my `getAllExercises()`, `getAverages()`, `getTopTargets()`, and `getTopExercises()` queries as these all involve connection of the Exercise and Workout tables.

## Workout user_id, date
This is the first index that I explicitly initialized as <user_id, date>, as it is used in all of my report queries (`getAllExercises()`, `getAverages()`, `getTopTargets()`, and `getTopExercises()`). It is initialized as a B+ Tree index to support range queries, as for my filter conditions we often query the workout table for a specific user_id between an explicit date range. As such, it makes the most sense for an index to support efficient finding of workouts corresponding to a certain user between a minimum and maximum date range. These queries can be quite selective given a small date range and an exact lookup on user_id, and as such, are greatly helped by the index.

## Exercise reps, sets
This is the second index that I explicitly initialized as <reps, sets>, as it is also used in all of my report queries (`getAllExercises()`, `getAverages()`, `getTopTargets()`, and `getTopExercises()`). It is initialized as a B+ Tree index to support range queries, as for my filter conditions we often query the Exercise table over a specific rep range. As such, it makes the most sense for an index to support efficient finding of exercises corresponding to a specific rep range. These queries can be quite selective given a small rep range, and so they are helped greatly by the index. I chose to include sets in the index because while it is not supported right now, there could be use in searching for specific set ranges in combination with rep ranges to find a specific focus (e.g. low set volume, high rep range sets).


## Auth.js Indexes
Auth.js, the authentication provider I chose to use, has specific schema required for its successful usage with a database. While I don't have access to the code under the hood, the schema it requires features primary key indexes on many different tables such as User, Account, Session, Verification Token, and Authenticator that I can reasonably conclude speed up authentication procedures. These are all B+ tree indexes as they are the default indexes auto-generated by Prisma, but they are not explicitly utilized in my code.